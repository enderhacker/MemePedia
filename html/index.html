<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=800,initial-scale=1" />
		<title>MemePedia</title>
		<meta name="description" content="The best meme community online!" />
		<link rel="stylesheet" href="/24d8fbbc0b0629acf787bb9ece916f209c6184526a6ec6fa628d9bc2840c7764" />
		<style>
			body {
				margin: 0;
				background: #f3efe9 url("grid.png");
				font-family: Tahoma, Verdana, Arial, sans-serif;
				color: #111;
				font-size: 14px;
				line-height: 1.4;
			}
			#wrapper {
				width: 800px;
				margin: 20px auto;
				border: 4px solid #222;
				background: #fff;
				box-shadow: 6px 6px 0 rgba(0, 0, 0, 0.15);
			}
			header {
				background: linear-gradient(#ffd6a5, #ffb4a2);
				padding: 12px 14px;
				display: flex;
				align-items: center;
				gap: 12px;
			}
			.logo {
				width: 72px;
				height: 60px;
				background: url("logo-old.gif") center/contain no-repeat;
				border: 1px solid #999;
			}
			h1 {
				margin: 0;
				font-size: 22px;
				color: #1b1b3a;
				text-shadow: 1px 1px 0 #fff;
			}
			.tagline {
				font-size: 12px;
				color: #333;
				margin-top: 4px;
			}
			nav {
				padding: 8px 12px;
				background: #f9f6f2;
				border-top: 2px solid #eee;
				border-bottom: 2px dashed #ddd;
			}
			nav a {
				margin-right: 8px;
				color: #0645ad;
				text-decoration: none;
				font-weight: bold;
			}
			.layout {
				display: flex;
				gap: 12px;
				padding: 12px;
			}
			.main {
				flex: 1;
			}
			.side {
				width: 220px;
				background: #fff;
				padding: 10px;
				border-left: 2px dotted #ddd;
			}
			.card {
				background: #fff;
				padding: 10px;
				margin-bottom: 12px;
				border: 1px solid #e0d8d2;
			}
			.marquee {
				background: #1b1b3a;
				color: #fff;
				padding: 6px;
				margin-bottom: 10px;
				font-weight: bold;
			}
			.marquee marquee {
				color: #fff;
			}
			.small-gif {
				width: 110px;
				height: 78px;
				border: 1px solid #ccc;
				display: block;
				margin-bottom: 6px;
			}
			.counter {
				font-family: "Courier New", monospace;
				background: #000;
				color: #0f0;
				padding: 4px 6px;
				display: inline-block;
				border-radius: 4px;
			}
			.wiki-list {
				list-style: square;
				padding-left: 18px;
				margin: 8px 0;
			}
			.forum-entry {
				border-bottom: 1px dashed #eee;
				padding: 8px 0;
				font-size: 13px;
				color: #222;
			}
			.forum-meta {
				font-size: 12px;
				color: #666;
				margin-top: 6px;
			}
			#ads-container {
				display: flex;
				flex-direction: column;
				border: 1px solid lightgray;
				background: antiquewhite;
				padding: 0px 10px;
				margin-bottom: 10px;
			}
			.ad {
				padding: 8px;
				border: 2px solid #ddd;
				margin-bottom: 10px;
				background: linear-gradient(#fff, #f0f0f0);
				cursor: pointer;
				text-align: center;
			}
			.ad img {
				max-width: 100%;
				height: auto;
				display: block;
				margin: 0 auto 6px;
			}
			.footer {
				padding: 10px;
				text-align: center;
				font-size: 12px;
				background: #f4f4f4;
				border-top: 1px solid #ddd;
			}

			body,
			p,
			li {
				font-size: 14px;
				line-height: 1.4;
			}

			.fiction-exit {
				position: fixed;
				left: 12px;
				bottom: 12px;
				background: #fff;
				border: 2px solid #111;
				padding: 6px 8px;
				font-weight: bold;
				z-index: 999;
				text-decoration: none;
				color: #111;
			}

			@media (max-width: 840px) {
				#wrapper {
					width: 96%;
					margin: 12px auto;
				}
				.layout {
					flex-direction: column;
				}
				.side {
					width: 100%;
					border-left: none;
					border-top: 2px dotted #ddd;
				}
			}

			#popup-overlay {
				display: none;
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(0, 0, 0, 0.5);
				justify-content: center;
				align-items: center;
				z-index: 1000;
			}

			#popup {
				background: #fdf5e6;
				border: 4px solid #c58a4a;
				padding: 20px 25px;
				width: 360px;
				max-width: 90%;
				box-shadow: 6px 6px 0 rgba(0, 0, 0, 0.2);
				text-align: center;
			}

			#popup h2 {
				margin: 0 0 10px 0;
				font-size: 20px;
				color: #1b1b3a;
				text-shadow: 1px 1px 0 #fff;
			}

			#popup p {
				margin: 8px 0;
				font-size: 14px;
				text-align: left;
			}

			#popup button {
				background: #d6a86a;
				border: 2px outset #ffdba0;
				padding: 6px 12px;
				cursor: pointer;
				font-weight: bold;
				transition: 0.1s;
			}

			#popup button:hover {
				background: #c58a4a;
				border: 2px outset #ffdba0;
				color: #fff;
			}

			/* Checkbox container */
			.checkbox-label {
				position: relative;
				display: block;
				margin: 12px 0;
				font-size: 13px;
				cursor: pointer;
				text-align: left;
				user-select: none;
				padding-left: 24px;
			}

			/* Hide default checkbox */
			.checkbox-label input[type="checkbox"] {
				position: absolute;
				opacity: 0;
				cursor: pointer;
				height: 0;
				width: 0;
			}

			/* Custom checkbox box */
			.checkbox-tick {
				position: absolute;
				left: 0;
				top: 0;
				width: 16px;
				height: 16px;
				background: #ffdba0;
				border: 2px outset #d6a86a;
			}

			/* Tick mark */
			.checkbox-label input:checked + .checkbox-tick::after {
				content: "";
				position: absolute;
				left: 4px;
				top: 0px;
				width: 5px;
				height: 10px;
				border: solid #c58a4a;
				border-width: 0 2px 2px 0;
				transform: rotate(45deg);
			}
		</style>
	</head>
	<body>
		<div id="popup-overlay">
			<div id="popup">
				<h2>Welcome to MemePedia!</h2>
				<p>The best page for memes. This site is best viewed on a computer or laptop with an internet connection, at least 16MB of RAM and 10MB of disk space. Phones are not recommended. For best experience, use Google Chrome.</p>
				<label class="checkbox-label"> <input type="checkbox" id="dont-show-again" />Do not show this message again<span class="checkbox-tick"></span> </label>
				<button id="close-popup">OK</button>
			</div>
		</div>
		<script>
			if (!localStorage.getItem("hideMemePediaPopup")) {
				document.getElementById("popup-overlay").style.display = "flex";
			}

			document.getElementById("close-popup").addEventListener("click", function () {
				if (document.getElementById("dont-show-again").checked) {
					localStorage.setItem("hideMemePediaPopup", "true");
				}
				document.getElementById("popup-overlay").style.display = "none";
			});
		</script>
		<div id="wrapper">
			<header>
				<a href="/" class="logo" aria-label="MemePedia home" style="background: none">
					<img src="/9fd8a9b27cf86d9129f1edc6c2d47e25cb8f3cfe11984d1a67b946f00ee4b8c4" alt="MemePedia logo" width="72" height="60" style="display: block; border: 0" />
				</a>
				<div>
					<h1>MemePedia [HOME]</h1>
					<div class="tagline">The best meme community online!</div>
				</div>
			</header>

			<nav>
				<a href="/">Home</a>
				<a href="#" onclick="alert('Cannot seem to find refered page. Please contact site administrator if you think this is an error.'); return false;">Wiki</a>
				<a href="/c40fbc15b206edccd7b21b63c5379d9b049598fadd81544e26de27e501572da9">Forum</a>
				<a href="/395b46de6c56b0518e08b07182c1ff4a340e0bb6ca7b315a8967a4d02b44b76d">Gallery</a>
				<a href="/bec5d5040b7df76f319de5e40a82ad1335d9ab3d23f4f6ff1ab6597c72819333">About</a>
				<span style="float: right; margin-right: 8px">
					<img src="/ac57241fc9a4a09696dff89272598c2594365686d25e84137d207fd4c49f6f2b" alt="hit counter" style="vertical-align: middle; height: 24px; border: 1px solid #555" />
					<span class="counter" id="visits">000,000,000</span>
				</span>
			</nav>

			<div class="layout">
				<div class="main">
					<div class="marquee"><marquee behavior="scroll" direction="left">Welcome to the MemePedia, the best meme community online!</marquee></div>

					<div class="card">
						<h3 style="margin-top: 0">Featured Wiki Entries</h3>
						<ul class="wiki-list">
							<li><strong>Doge-Origins</strong>: a short note about early Doge edits and misattributions.</li>
							<li><strong>Pixel-Bread</strong>: the 2005 bread-pixel craze explained.</li>
							<li><strong>Reaction-GIFS</strong>: a catalog of reaction gifs and their captions.</li>
							<li><strong>["+1" culture]</strong>: micro-history of upvote languages.</li>
						</ul>
					</div>

					<div class="card">
						<h3 style="margin-top: 0">Community Gallery</h3>
						<a href="/395b46de6c56b0518e08b07182c1ff4a340e0bb6ca7b315a8967a4d02b44b76d"><img src="/84f5ce8c30a621f6ef34a8a38b9a12c1c75c187d6f442b27a6edc6cc40413a9b" alt="gallery" style="width: 100%; border: 2px solid #eee" /></a>
						<p style="font-size: 12px; color: #666; margin-top: 8px">Photos and gifs collected from old mirrors. Some audio files included.</p>
					</div>

					<div class="card">
						<h3 style="margin-top: 0">Recent forum highlights</h3>

						<div class="forum-entry">
							<strong>OldSkool99</strong> | <em>Re: Pixel-Bread</em>
							<div class="forum-meta">Posted Apr 12, 2004 - 09:14</div>
							<div>anyone remember the original sprite? i have a floppy with it lol</div>
						</div>

						<div class="forum-entry">
							<strong>Memetron</strong> | <em>Re: Doge-Origins</em>
							<div class="forum-meta">Posted Jul 03, 2006 - 22:41</div>
							<div>it was just a typo that took over. the dog never knew what hit him.</div>
						</div>

						<div class="forum-entry">
							<strong>lurker</strong> | <em>Off-topic</em>
							<div class="forum-meta">Posted Sep 19, 2007 - 02:02</div>
							<div>does anyone still visit the old boards? nostalgia trip tonight.</div>
						</div>

						<div class="forum-entry">
							<strong>PixelFanatic</strong> | <em>Re: Reaction-GIFS</em>
							<div class="forum-meta">Posted Jan 11, 2008 - 14:27</div>
							<div>i miss the days when gifs were low-res and full of charm.</div>
						</div>

						<div class="forum-entry">
							<strong>TechGuru</strong> | <em>Has anyone else seen that weird proyect something ad?</em>
							<div class="forum-meta">Posted Nov 05, 2009 - 18:33</div>
							<div>I keep seeing ads for "Project Unveil" on some sites. Anyone know what that's about?</div>
						</div>

						<div class="forum-entry">
							<strong>Admin</strong> | <em>Site Archive Notice</em>
							<div class="forum-meta">Posted Dec 31, 2009 - 23:59</div>
							<div>As of today, MemePedia is archived for preservation. No new posts or accounts will be active.</div>
						</div>
					</div>
				</div>
				<aside class="side">
					<div class="card">
						<h4 style="margin-top: 0">Quick Links</h4>
						<p style="margin: 6px 0">
							<a href="#" onclick="alert('Cannot seem to find refered page. Please contact site administrator if you think this is an error.'); return false;">All Entries</a><br />
							<a href="#" id="random-meme">Random Meme</a><br />
							<a href="#" onclick="alert('Cannot seem to find refered page. Please contact site administrator if you think this is an error.'); return false;">Submit</a>
						</p>
					</div>
					<div id="ads-container">
						<h4 style="margin: 5px 0px">Advertisements:</h4>
						<div class="card ad">
							<img src="" alt="" />
							<div style="font-weight: bold">Loading...</div>
							<div style="font-size: 12px; color: #444; margin-top: 6px">Loading...</div>
						</div>
						<div class="card ad">
							<img src="" alt="" />
							<div style="font-weight: bold">Loading...</div>
							<div style="font-size: 12px; color: #444; margin-top: 6px">Loading...</div>
						</div>
					</div>
					<div class="card">
						<h4 style="margin: 0 0 6px 0">About this snapshot</h4>
						<p style="font-size: 13px; color: #555; margin: 0">Feel free to ask the mods if you need something!</p>
					</div>
				</aside>
			</div>
			<footer class="footer">Â© MemePedia | 2001-2009</footer>
		</div>

		<script>
			(() => {
				const link = document.getElementById("random-meme");
				const IMAGES = [
					"/79b81ff2a8cf7ebad4d95c1b7351f24a83e7a8d319da2f6e9a0b3af2bb12e597",
					"/3e4a0bdf58f4a7a99f3c2b14cb987e6cdd46a3d8bf64b1b6b3a92a0dfb7814b6",
					"/6a5142ac9b9b985f27e861bbd4e33c6ad2d2af7e05a284e79b83e68266dcbfc7",
					"/48a87d19adf0f0dcfbf41e41bcb2875b90a8b5f5b46c929e8d29b20368cd9618",
					"/72a44cb9a9bfa47f93e04f5a8d1a37961a2efb8bc44c18f4038d20b5e9b4cf10",
					"/e03d9c1d3a47a9652d873b1e8d01b4cf5c28d173cba7e8b480a2196b4283d251",
					"/e7421d2c7b4d2a8a4236c7b2c3f1a8b6d2c937e14efad237b0de5a6fa7a9d5cb",
					"/0bce4769b4cbe2280f27e8e7699a13b7e3c43efc861ffb9ef3b6995bbcc23f5d",
				];
				const CORRUPTED = "/3e4a0bdf58f4a7a99f3c2b14cb987e6cdd46a3d8bf64b1b6b3a92a0dfb7814b6";

				function openViewer() {
					const win = window.open("", "randomMemeWindow", "width=1000,height=800,scrollbars=yes,resizable=yes");
					if (!win) return;
					const doc = win.document;

					let currentImg = null; // track currently displayed image

					const pick = (exclude = null) => {
						let options = IMAGES.filter((i) => i !== exclude);
						return options[Math.floor(Math.random() * options.length)];
					};

					const showImage = (img) => {
						currentImg = img;
						meme.src = img;
					};

					let initialImg = pick(); // first image (cannot be CORRUPTED)
					while (initialImg === CORRUPTED) initialImg = pick();

					doc.open();
					doc.write(`<!doctype html>
<html>
		<head>
			<meta charset="utf-8">
			<meta name="viewport" content="width=device-width,initial-scale=1">
			<title>Random Meme - MemePedia Meme Viewer</title>
			<style>
				body{margin:0;font-family:"Comic Sans MS","Trebuchet MS",Arial,sans-serif;background:#004466 url("/tiling-bg.gif") repeat;color:#fff;}
				.page{width:880px;margin:12px auto;border:4px solid #000;background:url("/paper-texture.png") #f8f0e0;padding:8px;}
				.header{background:linear-gradient(#ff66cc,#ffcc00);padding:8px;border:2px solid #000;color:#000;display:flex;align-items:center;gap:10px;}
				.logo{width:88px;height:64px;display:flex;align-items:center;justify-content:center;border:2px outset #fff;}
				.title{font-size:24px;text-shadow:2px 2px 0 #fff;}
				.topbar{background:#222;color:#0f0;padding:6px;font-family:courier,monospace;margin-top:6px;border-top:2px solid #000;}
				.layout{display:table;width:100%;margin-top:10px;}
				.col-left{display:table-cell;width:200px;vertical-align:top;padding:8px;border-right:2px dashed #333;background:linear-gradient(#ffeebb,#fff2cc)}
				.col-main{display:table-cell;padding:12px;vertical-align:top;}
				.btn{display:inline-block;padding:6px 10px;background:#fff;color:#000;border:2px outset #ccc;margin-right:6px;cursor:pointer;text-decoration:none;border-radius:4px;font-weight:bold}
				.meme-wrap{width:100%;height:520px;display:flex;align-items:center;justify-content:center;background:#000;border:4px solid #fff;padding:12px;box-sizing:border-box;}
				.meme-wrap img{max-width:100%;max-height:100%;border:4px solid #ffb6c1;background:#222}
				.note{font-size:12px;color:#000;margin-top:8px;background:#fff;padding:6px;border:2px groove #999;}
				.retro-gif{display:block;margin:6px auto;}
				.marq{margin-top:8px;background:#000;color:#0f0;padding:4px;border:2px solid #0f0;text-align:center;font-weight:bold;}
				.blink{animation:blink 1s steps(2,start) infinite}@keyframes blink{50%{opacity:0}}
				a.retro-link{color:#0033cc;text-decoration:underline;font-weight:bold;}
			</style>
		</head>
		<body>
			<audio id="corrupted-sfx" src="/ded2d40110abb9075e42bb31f69a6799bf25e515a8403549d4a8f0706877da9e" preload="auto"></audio>
			<div class="page">
				<div class="header">
					<div class="logo"><img src="/9fd8a9b27cf86d9129f1edc6c2d47e25cb8f3cfe11984d1a67b946f00ee4b8c4" width="88" height="64" alt="MemePedia logo"></div>
					<div class="title">MemePedia - Random Meme Viewer</div>
				</div>
				<div class="topbar">Visitor counter:
					<span style="background:#000;color:#0f0;padding:2px 6px;border-radius:3px;font-family:courier,monospace">
						${String(Date.now() % 1000000).padStart(6, "0")}
					</span>
					&nbsp;|&nbsp;<span class="blink">The Best Memes In Town!</span>
				</div>
				<div class="layout">
					<div class="col-left">
						<img src="/a5f3b9b2c85a8c5baf95f7c83c6a429f2b9e7a3df7d12b8e4325bfb9b47ed820" alt="under construction" width="160" class="retro-gif">
						<p><a href="#" class="retro-link" id="guestbook">Sign Guestbook</a></p>
						<p><a href="#" class="retro-link" id="home">Back to MemePedia</a></p>
						<p class="note">Tip: click "Another" for a new random image. Right-click to save as.</p>
					</div>
					<div class="col-main">
						<div style="margin-bottom:8px">
							<button id="another" class="btn">Another</button>
							<button id="openraw" class="btn">Open image in new tab</button>
						</div>
						<div class="marq"><marquee behavior="alternate" scrollamount="4">
							Welcome to The MemePedia Meme Viewer | Enjoy a list of well-selected memes! Contact our mods to add more memes!
						</marquee></div>
						<div class="meme-wrap"><img id="meme" src="${initialImg}" alt="Random Meme"></div>
						<div style="margin-top:8px;display:flex;gap:8px;align-items:center">
							<div style="margin-left:auto;color:#000;background:#fff;padding:4px;border:2px inset #aaa;font-size:12px">Memes uploaded by our community! Feel free to share yours ;)</div>
						</div>
					</div>
				</div>
			</div>
<script>
const IMAGES = ${JSON.stringify(IMAGES)};
const CORRUPTED = "${CORRUPTED}";
const meme = document.getElementById("meme");
const sfx = document.getElementById("corrupted-sfx");
const another = document.getElementById("another");
const openraw = document.getElementById("openraw");

let currentImg = "${initialImg}";

const pickImage = (exclude) => {
  const options = IMAGES.filter(i => i !== exclude);
  return options[Math.floor(Math.random() * options.length)];
};

const showMeme = (img) => {
  currentImg = img;
  meme.src = img;
};

another.onclick = () => {
  let img = pickImage(currentImg);
  showMeme(img);
  if (img === CORRUPTED) {
    [another, openraw].forEach(b => b.disabled = true);
    sfx.currentTime = 0; sfx.play();
    setTimeout(() => {
      alert('Unexpected image detected, restoring...');
      let safe;
      do { safe = pickImage(null); } while (safe === CORRUPTED);
      showMeme(safe);
      [another, openraw].forEach(b => b.disabled = false);
    }, 5000);
  }
};

openraw.onclick = () => window.open(meme.src, "_blank");
<\/script>
</body>
</html>`);
					doc.close();
				}

				link?.addEventListener("click", (e) => {
					e.preventDefault();
					openViewer();
				});
			})();

			// --- Ads Loader ---
			window.addEventListener("DOMContentLoaded", async () => {
				const container = document.getElementById("ads-container");
				container.innerHTML = '<h4 style="margin: 5px 0px;">Advertisements:</h4>';

				let currentAds = []; // store current ads

				// Function to render ads
				const renderAds = (ads) => {
					container.querySelectorAll(".ad").forEach((ad) => ad.remove()); // remove old ad elements
					ads.forEach((ad) => {
						const div = document.createElement("div");
						div.className = "card ad";
						div.innerHTML = `
				<img src="${ad.imageUrl}" alt="${ad.title}">
				<div style="font-weight:bold">${ad.title}</div>
				<div style="font-size:12px;color:#444;margin-top:6px">${ad.description}</div>`;
						div.onclick = () => {
							if (ad.redirectUrl) location.href = ad.redirectUrl;
							else alert("Cannot seem to find referred page. Please contact site administrator if you think this is an error.");
						};
						container.appendChild(div);
					});
				};

				// Function to fetch ads
				const fetchAds = async () => {
					try {
						const res = await fetch("/api/getAd");
						if (!res.ok) throw new Error("Network response was not ok");
						const ads = await res.json();
						currentAds = ads; // update current ads
						renderAds(ads);
					} catch (e) {
						console.warn("Failed to fetch new ads, keeping previous ones.");
						renderAds(currentAds); // re-render old ads
					}
				};

				// Initial load
				await fetchAds();

				// Rotate ads every 15 seconds
				setInterval(fetchAds, 15000);
			});

			(() => {
				const el = document.getElementById("visits");
				if (!el) return;

				fetch("/api/getVisits")
					.then((res) => (res.ok ? res.json() : Promise.reject()))
					.then((data) => {
						if (typeof data.visits === "number" && !isNaN(data.visits)) {
							const padded = data.visits.toString().padStart(9, "0");
							el.textContent = padded.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
						} else throw new Error();
					})
					.catch(() => (el.style.display = "none"));
			})();
		</script>
	</body>
</html>
